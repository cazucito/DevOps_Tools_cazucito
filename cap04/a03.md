# GIT

## SERVIDOR GIT

### OBJETIVOS

Al termino de este cap√≠tulo, ser√°s capaz de:

- Al finalizar ser√°s capaz de interactuar con plataformas de servidores de repositorios Git.

### DURACI√ìN

Tiempo aproximado para esta actividad:

- 40 minutos.

### PRERREQUISITOS

Para esta actividad se requiere:

- Acceso a Internet.
- Acceso mediante SSH a un servidor Linux.
- Conocimientos b√°sicos de la terminal de Linux.
- Actividad anterior completada.

### INSTRUCCIONES

En esta actividad te familiarizaras con una plataforma de control de versiones y colaboraci√≥n de c√≥digo. :leveloffset: +1

### PRERREQUISITOS

Para esta actividad necesitar√°s crear una cuenta en Bitbucket, GitHub y GitLab. Adem√°s necesitar√°s configurar el mecanismo de autenticaci√≥n de llaves SSH en tu computadora.

#### CUENTAS DE ACCESO

##### Bitbucket

[Bitbucket](<https://bitbucket.org/>) es una plataforma de gesti√≥n de c√≥digo fuente basada en **Git** desarrollada por Atlassian.

Permite a equipos de desarrollo gestionar repositorios, realizar integraciones continuas y colaborar en proyectos de software.

###### Pasos para crear una cuenta en Bitbucket

- Acceder al sitio web de Bitbucket
  - Abre tu navegador web y dir√≠gete a la p√°gina oficial de Bitbucket: **[<https://bitbucket.org/>](<https://bitbucket.org/>)**
- Iniciar el proceso de registro
  - En la p√°gina principal, haz clic en el bot√≥n **"Get started"** o **"Sign up"**.
- Ingresar la informaci√≥n requerida

Bitbucket permite registrarse utilizando:

- Una **direcci√≥n de correo electr√≥nico**.
- Una **cuenta de Google**.
- Una **cuenta de Atlassian** (si ya tienes una).

Si decides registrarte con tu correo electr√≥nico, deber√°s proporcionar:

- **Nombre completo**.
- **Direcci√≥n de correo electr√≥nico v√°lida**.
- **Nombre de usuario**.
- **Contrase√±a segura**.

- Confirmar el correo electr√≥nico
  - Bitbucket enviar√° un correo de verificaci√≥n a la direcci√≥n ingresada.
  - Abre tu bandeja de entrada y haz clic en el enlace de verificaci√≥n.
  - Si no recibes el correo, revisa tu carpeta de spam o intenta reenviar la verificaci√≥n desde Bitbucket.

¬°Listo! Ya tienes tu cuenta y puedes empezar a gestionar tu c√≥digo en Bitbucket.

##### GitHub

[GitHub](<https://github.com/>) es una plataforma de alojamiento de c√≥digo fuente basada en **Git**, que permite a desarrolladores y equipos colaborar en proyectos de software, realizar control de versiones y automatizar flujos de trabajo mediante GitHub Actions.

###### Pasos para crear una cuenta en GitHub

- Acceder al sitio web de GitHub
  - Abre tu navegador y dir√≠gete a la p√°gina oficial de GitHub: **[<https://github.com/>](<https://github.com/>)**
- Iniciar el proceso de registro
  - En la p√°gina principal, haz clic en el bot√≥n **"Sign up"**.
- Ingresar la informaci√≥n requerida
  - GitHub solicita los siguientes datos:
    - **Nombre de usuario** (√∫nico en la plataforma).
    - **Direcci√≥n de correo electr√≥nico v√°lida**.
    - **Contrase√±a segura**.

Despu√©s de completar estos datos, haz clic en **"Create account"**.

- Verificaci√≥n de seguridad
  - GitHub puede solicitar una verificaci√≥n **Captcha** para confirmar que no eres un bot.
  - Es posible que te env√≠en un c√≥digo de confirmaci√≥n al correo registrado.
- Confirmar el correo electr√≥nico
  - Revisa tu bandeja de entrada y abre el correo enviado por GitHub.
  - Haz clic en el enlace de verificaci√≥n para activar tu cuenta.

¬°Listo! Ahora tienes tu cuenta en GitHub y puedes empezar a gestionar tu c√≥digo.

##### GitLab

[GitLab](<https://gitlab.com/>) es una plataforma de gesti√≥n de c√≥digo fuente basada en **Git**, que ofrece un conjunto completo de herramientas para **integraci√≥n y entrega continua (CI/CD)**, gesti√≥n de proyectos y automatizaci√≥n del desarrollo de software.

###### Pasos para crear una cuenta en GitLab

- Acceder al sitio web de GitLab
  - Abre tu navegador y dir√≠gete a la p√°gina oficial de GitLab: **[<https://gitlab.com/>](<https://gitlab.com/>)**
- Iniciar el proceso de registro
  - En la p√°gina principal, haz clic en el bot√≥n **"Sign up / Register"**.
- Ingresar la informaci√≥n requerida
  - GitLab permite registrarse mediante:
    - Una **direcci√≥n de correo electr√≥nico**.
      - Si eliges registrarte con tu correo electr√≥nico, deber√°s proporcionar:
        - **Nombre de usuario**.
        - **Direcci√≥n de correo electr√≥nico v√°lida**.
        - **Contrase√±a segura**. 
    - Una **cuenta de Google** o **GitHub**.

Despu√©s de completar los datos, acepta los **T√©rminos y Condiciones** y haz clic en **"Register"**.

- Confirmar el correo electr√≥nico
  - GitLab enviar√° un correo de verificaci√≥n a la direcci√≥n ingresada.
  - Abre tu bandeja de entrada y haz clic en el enlace de verificaci√≥n.
  - Si no encuentras el correo, revisa tu carpeta de spam o solicita un reenv√≠o.

¬°Listo! Ahora tienes tu cuenta en GitLab y puedes empezar a gestionar tu c√≥digo.

##### Consejos de Seguridad

Para mantener segura tu cuenta y repositorios, sigue estas recomendaciones:

- Habilita la **autenticaci√≥n en dos pasos (2FA)** en la configuraci√≥n de seguridad.
- Usa **claves SSH** para una autenticaci√≥n m√°s segura en tus repositorios.
- Mant√©n tu repositorio **privado** si contiene informaci√≥n sensible.

#### CONFIGURACI√ìN DE LLAVES SSH

Para autenticarse en los servicios de Bitbucket, GitHub y GitLab, necesitar√°s configurar un par de llaves SSH en tu computadora.

##### Validar la existencia de llaves SSH

Para verificar si ya tienes un par de llaves SSH en tu computadora, ejecuta el siguiente comando en la terminal del equipo de trabajo principal:

``` shell
ls -al ~/.ssh
```

Si obtienes una salida similar a la siguiente, significa que ya tienes un par de llaves SSH:

``` shell
total 20
drwx------ 2 netec netec 4096 Feb 10 16:46 .
drwxr-xr-x 6 netec netec 4096 Feb 11 11:34 ..
-rw------- 1 netec netec 2602 Feb 10 16:38 id_rsa
-rw-r--r-- 1 netec netec  567 Feb 10 16:38 id_rsa.pub
-rw-r--r-- 1 netec netec  444 Feb 10 16:46 known_hosts
```

###### Generar un par de llaves SSH

**Unicamente si no tienes un par de llaves SSH**, genera un nuevo par de llaves SSH en tu computadora de trabajo principal.

Para ello, ejecuta el siguiente comando:

``` shell
#ssh-keygen -t rsa -C "pedro.cazucito@netec.com"
#ssh-keygen -t ed25519 -C "pedro.cazucito@netec.com"
ssh-keygen
```

Donde:

- `-t ed25519`: Especifica el tipo de algoritmo de cifrado a utilizar.
- `-C "TU CORREO"`: Especifica una etiqueta para identificar la llave.

Contesta presionando la tecla `Enter` a las siguientes tres solicitudes de informaci√≥n.

A continuaci√≥n, se muestra una ejecuci√≥n del comando:

``` shell
Generating public/private ed25519 key pair.
Enter file in which to save the key (/home/usuario/.ssh/id_ed25519):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/usuario/.ssh/id_ed25519
Your public key has been saved in /home/usuario/.ssh/id_ed25519.pub
The key fingerprint is:
SHA256:NshhPwB/DBBp5rXobgETD76ba6Agiz2n7gAQ7x8d8Fg pedro.cabrera@fractalyst.com.mx
The keys randomart image is:
+--[ED25519 256]--
|.  =+E          |
| oo +B.o         |
|...B.oB.o        |
|..+ ++.B         |
|. .=. + S        |
|= ..o. . o       |
|*+ +..          |
|+.* +            |
| +=*             |
+----[SHA256]-----+
```

##### Adicionar llave SSH

Una vez generadas las llaves SSH, es necesario agregar la llave p√∫blica a tu cuenta de Bitbucket, GitHub y GitLab.

Recuerda que la llave p√∫blica tiene la extensi√≥n `.pub` y se encuentra en la ruta `~/.ssh/id_rsa.pub`. Para visualizar el contenido de la llave p√∫blica, ejecuta el siguiente comando:

``` shell
cat ~/.ssh/id_rsa.pub
```

La salida del comando mostrar√° la llave p√∫blica que debes agregar a tu cuenta en las plataformas de control de versiones.

``` shell
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCsFF5gvPDU4yhqo1Xa185QUvBnLUtXKc4nD1LBelIeXULSH18e70r/PeIhcagANcRlBT9ogRlqKlsZZqvCC1YIr/+/6iI78+ZOZtadxsG+dVfGdx31M8n1KQiGDIg5DdHsTHaphVsqLdC0br1xKZA8fta6YlhiCcvqAIYHyjABDFcftEPaqvRR7B59CI4P7RFsoO3j/EMVxBpbfKXBP2qxJFbSmbbEVuELAruWCBPE3UIFb1aFT6qYXoZUO92kqdDJf8YoAmEPLoPGq7pPM9HbdMMri4D79o3EdLIBw2uQLF4H2kx5Qou/E= netec@devops1
```

<div class="note">

El texto mostrado es un ejemplo. Tu llave p√∫blica ser√° diferente. Puede variar en longitud y contenido. Es importante mencionar que el contenido de la llave esta en una sola l√≠nea.

</div>

###### Bitbucket

Para agregar tu llave SSH a Bitbucket, sigue estos pasos:

1. Accede a tu cuenta de Bitbucket.
2. Haz clic en tu avatar y selecciona **"Bitbucket settings"**.
3. En el men√∫ lateral, selecciona **"SSH keys"**.
4. Haz clic en **"Add key"**.
5. En la ventana emergente, copia el contenido de tu llave p√∫blica (`~/.ssh/id_rsa.pub`) y p√©galo en el campo **"Key"**.
6. Asigna un nombre descriptivo a la llave y haz clic en **"Add key"**.

- Enlace directo: <https://bitbucket.org/account/settings/ssh-keys/>

![Bitbucket - Agregar llave SSH](mm/04-03-01_Bitbucket_AddSSHKey.png)

**Validar la conexi√≥n**

Para validar la conexi√≥n SSH con Bitbucket, ejecuta el comando mostrado adelante en la terminal de tu equipo de trabajo principal. Si solicita confirmaci√≥n, responde con `yes`.

``` shell
ssh -T git@bitbucket.org
```

La salida del comando mostrar√° un mensaje de confirmaci√≥n de la conexi√≥n exitosa.

``` shell
The authenticity of host 'bitbucket.org (104.192.142.26)' can't be established.
ECDSA key fingerprint is SHA256:FC73VB6C4OQLSCrjEayhMp9UMxS97caD/Yyi2bhW/J0.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'bitbucket.org,104.192.142.26' (ECDSA) to the list of known hosts.
authenticated via ssh key.

You can use git to connect to Bitbucket. Shell access is disabled
```

###### GitHub

Para agregar tu llave SSH a GitHub, sigue estos pasos:

1. Accede a tu cuenta de GitHub.
2. Haz clic en tu avatar y selecciona **"Settings"**.
3. En el men√∫ lateral, selecciona **"SSH and GPG keys"**.
4. Haz clic en **"New SSH key"**.
5. En el campo **"Title"**, asigna un nombre descriptivo a la llave.
6. En el campo **"Key"**, copia el contenido de tu llave p√∫blica (`~/.ssh/id_rsa.pub`).
7. Haz clic en **"Add SSH key"**.

- Enlace directo: <https://github.com/settings/keys>

![GitHub - Agregar llave SSH](mm/04-03-02_GitHub_AddSSHKey.png)

**Validar la conexi√≥n**

Para validar la conexi√≥n SSH con GitHub, ejecuta el comando mostrado adelante en la terminal de tu equipo de trabajo principal. Si solicita confirmaci√≥n, responde con `yes`.

``` shell
ssh -T git@github.com
```

La salida del comando mostrar√° un mensaje de confirmaci√≥n de la conexi√≥n exitosa.

``` shell
The authenticity of host 'github.com (140.82.114.3)' can't be established.
ECDSA key fingerprint is SHA256:p2QAMXNIC1TJYWeIOttrVc98/R1BUFWu3/LiyKgUfQM.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'github.com,140.82.114.3' (ECDSA) to the list of known hosts.
Hi cazucito! You've successfully authenticated, but GitHub does not provide shell access.
```

###### GitLab

Para agregar tu llave SSH a GitLab, sigue estos pasos:

1. Accede a tu cuenta de GitLab.
2. Haz clic en tu avatar y selecciona **"Preferences"**.
3. En el men√∫ lateral, selecciona **"SSH keys"**.
4. En el campo **"Key"**, copia el contenido de tu llave p√∫blica (`~/.ssh/id_rsa.pub`).
5. Asigna un t√≠tulo descriptivo a la llave y haz clic en **"Add key"**.

- Enlace directo: <https://gitlab.com/-/user_settings/ssh_keys>

![GitLab - Agregar llave SSH](mm/04-03-03_GitLab_AddSSHKey.png)

**Validar la conexi√≥n**

Para validar la conexi√≥n SSH con GitHub, ejecuta el comando mostrado adelante en la terminal de tu equipo de trabajo principal. Si solicita confirmaci√≥n, responde con `yes`.

``` shell
ssh -T git@gitlab.com
```

La salida del comando mostrar√° un mensaje de confirmaci√≥n de la conexi√≥n exitosa.

``` shell
The authenticity of host 'gitlab.com (172.65.251.78)' can't be established.
ECDSA key fingerprint is SHA256:HbW3g8zUjNSksFbqTiUWPWg2Bq1x8xdGUrliXFzSnUw.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'gitlab.com,172.65.251.78' (ECDSA) to the list of known hosts.
Welcome to GitLab, @cazucito!
```

### CREACI√ìN DE REPOSITORIO

#### Bitbucket

Ya autenticado en Bitbucket, vamos a crear un nuevo repositorio.

En ocasiones se requiere crear un espacio de trabajo (workspace) en Bitbucket, si no lo has hecho, sigue los pasos en la interfaz de Bitbucket.

![Creaci√≥n de un espacio de trabajo en Bitbucket.](mm/04-03-04_Bitbucket_Workspace.png)

##### Creaci√≥n del Repositorio "DevOpsTools"

1. En la parte superior, haz clic en el bot√≥n **"Create"**.

2. Selecciona **"Repository"** en el men√∫ desplegable.

![Creaci√≥n de un repositorio en Bitbucket](mm/04-03-05_Bitbucket_CreateRepo.png)

Completa el formulario con la siguiente informaci√≥n:

- **Project name**: `DevOpsTools-Project`
- **Repository name**: `devops-tools`
- **Access level**:
  - **Private** (recomendado para proyectos internos o sensibles).
  - **Public** (visible para cualquier usuario).
- **Include a README?**: Marca esta opci√≥n para inicializar el repositorio con un archivo `README.md`.
- **Default branch**: `main`.
- **Include a .gitignore?**: Selecciona un archivo `.gitignore` basado en el lenguaje del proyecto.

![Creaci√≥n de un repositorio en Bitbucket](mm/04-03-06_Bitbucket_CreateRepo.png)

##### Finalizar la Creaci√≥n

- Una vez configurado el repositorio, haz clic en **"Create repository"**.
- Bitbucket te redirigir√° a la p√°gina del repositorio reci√©n creado.

![Creaci√≥n de un repositorio en Bitbucket](mm/04-03-07_Bitbucket_CreateRepo.png)

#### Clonar el Repositorio Localmente

Para trabajar con el repositorio en tu m√°quina, cl√≥nalo usando `git`:

``` sh
git clone git@bitbucket.org:netec-dev/devops-tools.git
```

Recuerda reemplazar `netec-dev` por tu usuario de Bitbucket.

La salida ser√° similar a:

``` sh
Cloning into 'devops-tools'...
Warning: Permanently added the ECDSA host key for IP address '104.192.142.24' to the list of known hosts.
remote: Enumerating objects: 4, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 4 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)
Receiving objects: 100% (4/4), done.
```

Para evitar cualquier problema con el nombrado de las carpetas, cambia el nombre del directorio de `devops-tools` a `devops-tools_bitbucket`. (`mv devops-tools/ devops-tools_bitbucket`)

#### Agregar y Subir Archivos al Repositorio

Posici√≥nate en el directorio del repositorio y realiza alguna modificaci√≥n en los archivos.

Por ejemplo cambia el contenido del archivo `README.md` por el propuesto.

- Sustituye `[Juan P√©rez]` por tu nombre.

``` markdown
# üìò Curso de DevOps Tools: Herramientas y Pr√°cticas üöÄ

Este curso est√° dise√±ado para proporcionar una visi√≥n integral de las herramientas y metodolog√≠as **DevOps**. Aprender√°s sobre **gesti√≥n de proyectos (Jira)**, **automatizaci√≥n (Ansible)**, **control de versiones (Git, GitHub, GitLab, Bitbucket)**, **integraci√≥n y entrega continua (Jenkins)**, **an√°lisis de c√≥digo (SonarQube)**, **gesti√≥n de artefactos (Artifactory, Nexus)**, **contenedores (Docker, Kubernetes)** y **pruebas continuas**.

## Participante

üë§ **Nombre**: [Juan P√©rez]

## üìë Temario
üîπ **Introducci√≥n a DevOps**: Principios, ciclo de vida y estrategias.
üîπ **Gesti√≥n de Proyectos con Jira**: Creaci√≥n y administraci√≥n de tareas, Kanban y Scrum.
üîπ **Automatizaci√≥n con Ansible**: Instalaci√≥n, Playbooks y despliegues automatizados.
üîπ **Control de Versiones con Git**: Flujo de trabajo, resoluci√≥n de conflictos y plataformas Git.
üîπ **CI/CD con Jenkins**: Configuraci√≥n, creaci√≥n de Jobs y Pipelines avanzados.
üîπ **An√°lisis de C√≥digo con SonarQube**: Evaluaci√≥n de calidad, m√©tricas y mejoras.
üîπ **Gesti√≥n de Artefactos**: Uso de Artifactory y Nexus en entornos DevOps.
üîπ **Contenedores con Docker y Kubernetes**: Orquestaci√≥n y despliegue en cl√∫steres.
üîπ **Pruebas Continuas**: Desarrollo guiado por comportamiento, pruebas E2E e integraci√≥n con Jenkins.

## üõ† Herramientas Utilizadas
Jira ‚Ä¢ Ansible ‚Ä¢ Git ‚Ä¢ GitHub ‚Ä¢ GitLab ‚Ä¢ Bitbucket ‚Ä¢ Jenkins ‚Ä¢ SonarQube ‚Ä¢ Artifactory ‚Ä¢ Nexus ‚Ä¢ Docker ‚Ä¢ Kubernetes

üìå **¬°Optimiza tu flujo de trabajo con DevOps y lleva tu desarrollo al siguiente nivel! üöÄ**
```

Guarda los cambios y sube los archivos al repositorio:

``` sh
git add README.md
git commit -m "Actualizaci√≥n del archivo README.md"
```

La salida ser√° similar a:

``` sh
[main 52566ba] Actualizaci√≥n del archivo README.md
 1 file changed, 23 insertions(+), 45 deletions(-)
 rewrite README.md (99%)
```

Y para subir los cambios:

``` sh
git push origin main
```

``` sh
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 4 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 1.13 KiB | 1.13 MiB/s, done.
Total 3 (delta 0), reused 0 (delta 0)
To bitbucket.org:netec-dev/devops-tools.git
   c538703..52566ba  main -> main
```

![Flujo de trabajo en Bitbucket](mm/04-03-08_Bitbucket_FlujoSimple.png)

#### GitHub y GitLab (OPCIONAL)

Repita los pasos anteriores para crear un repositorio en GitHub y GitLab.

## RESULTADO

Al finalizar ser√°s capaz de interactuar con plataformas de servidores de repositorios Git.

![Resultado esperado](mm/04-03_Outcome.png)
